<div id="wrapper">

  <!--Acá va la barra de navegación-->

  <app-nav-bar></app-nav-bar>
  <div style="width: 100vw; height: calc(100% - 64px);" fxLayout="row" fxLayout.lt-sm="column"  fxFill>
		<div fxFlex="30" fxFlex.lt-sm="50">
      <div fxLayout="column" class="f-height">

        <div fxFlex="55">

          <mat-tab-group mat-stretch-tabs  color="primary" class="full-width-height mat-elevation-z1">
            <mat-tab label="Filtrar"> 

              <div class="f-min-height-width-padding" fxLayout="column" class="f-height" fxLayoutAlign="space-between">

                <button mat-icon-button class="more-button" [matMenuTriggerFor]="menu" aria-label="Toggle menu">
                  <mat-icon>more_vert</mat-icon>
                </button>
                <mat-menu #menu="matMenu" xPosition="before">
                  <button mat-menu-item>Limpiar</button>
                </mat-menu>

              <!--Acá va el filtro por fecha-->

              <mat-card fxFlex>         
                <mat-card-subtitle>Filtrar por fecha</mat-card-subtitle>
                <form [formGroup]="filtroForm">
                <div fxLayout="row wrap" fxLayoutAlign="center" fxLayoutGap="10px" fxLayoutAlign="space-evenly center">

                  
                    <mat-form-field fxFlex>
                      <mat-label>Fecha de inicio</mat-label>
                      <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="picker" formControlName="fechaInicio">
                      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                      <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>
                    <mat-form-field fxFlex>
                      <mat-label>Fecha de fin</mat-label>
                      <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="picker2" formControlName="fechaFin">
                      <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                      <mat-datepicker #picker2></mat-datepicker>
                    </mat-form-field>
                  
                  
                </div>
                <button mat-button type="button" (click)="check()" >Search</button>    
              </form>            
              </mat-card>
              
              <mat-divider></mat-divider>
              <!--Acá va el filtro por ubicación-->

              <mat-card fxFlex>
                <mat-card-subtitle>Filtrar por ubicación</mat-card-subtitle>
                <div fxLayout="row wrap" fxLayoutAlign="center" fxLayoutGap="10px" fxLayoutAlign="space-evenly center">
                  <!--Acá va el filtro por región-->
                  <mat-form-field fxFlex> 
                    <mat-label>Región</mat-label>
                    <mat-select 
                    disableOptionCentering
                    [(ngModel)]="selectedRegion"
                    (selectionChange) = "selectRegion()">
                      <mat-option *ngFor = "let reg of regiones" [value] = "reg.departamento">
                        {{reg.departamento}}
                      </mat-option>
                    </mat-select>
                    <button mat-button *ngIf="selectedRegion" matSuffix mat-icon-button aria-label="Borrar" (click)="deselectRegion()">
                      <mat-icon>close</mat-icon>
                    </button>
                  </mat-form-field>

                <!--Acá va el filtro por provincia-->

                <mat-form-field fxFlex>
                  <mat-label>Provincia</mat-label>
                  <mat-select 
                    disableOptionCentering
                    [(ngModel)]="selectedProvincia"
                    (selectionChange) = "selectProvincia()"
                    >
                    <mat-option *ngFor = "let pro of provinciasFiltradas" [value] = "pro.provincia">
                      {{pro.provincia}}
                    </mat-option>
                  </mat-select>
                  <button mat-button *ngIf="selectedProvincia" matSuffix mat-icon-button aria-label="Borrar" (click)="deselectProvincia()">
                    <mat-icon>close</mat-icon>
                  </button>
                </mat-form-field>

                <!--Acá va el filtro por distrito-->

                <mat-form-field fxFlex>
                  <mat-label>Distrito</mat-label>
                  <mat-select
                    [(ngModel)]="selectedDistrito"
                    (selectionChange) = "selectDistrito()"
                    >
                    <mat-option *ngFor = "let di of distritosFiltrados" [value] = "di.distrito">
                      {{di.distrito}}
                    </mat-option>
                  </mat-select>
                  <button mat-button *ngIf="selectedDistrito" matSuffix mat-icon-button aria-label="Borrar" (click)="deselectDistrito()">
                    <mat-icon>close</mat-icon>
                  </button>
                </mat-form-field>
                </div>
                
              </mat-card>

              <mat-divider></mat-divider>

              <!--Acá va el filtro por tipo-->

              <mat-card fxFlex>
                <mat-card-subtitle>Filtrar por tipo</mat-card-subtitle>
                <div fxLayout="row wrap" fxLayoutAlign="center" fxLayoutGap="10px" fxLayoutAlign="space-evenly center">
                  <mat-slide-toggle color="primary" fxFlex>Casos confirmados</mat-slide-toggle>
                  <mat-slide-toggle color="primary" fxFlex>Casos probables</mat-slide-toggle>
                  <mat-slide-toggle color="primary" fxFlex>Casos descartados</mat-slide-toggle>  
                
                </div>
              </mat-card>
            </div>

            </mat-tab>
  
            <!--Acá van nuevo features-->
  
            <mat-tab label="Gráficos"> 
              <ngx-charts-bar-vertical
              [view]="view"
              [scheme]="colorScheme"
              [results]="single"
              [gradient]="gradient"
              [xAxis]="showXAxis"
              [yAxis]="showYAxis"
              [legend]="showLegend"
              [showXAxisLabel]="showXAxisLabel"
              [showYAxisLabel]="showYAxisLabel"
              [xAxisLabel]="xAxisLabel"
              [yAxisLabel]="yAxisLabel"
              (select)="onSelect($event)">
            </ngx-charts-bar-vertical>
              
            </mat-tab>
            
          </mat-tab-group>
          
        </div>

        <div fxFlex="45" >

        <!--Acá va el panel de anuncios y/o alertas fxLayoutGap="16px"-->

          <mat-tab-group mat-stretch-tabs  color="primary" class="full-width-height mat-elevation-z4">
            <mat-tab label="Enviar Anuncio">
              <div class="f-min-height-width-padding" fxLayout="column" class="f-height" fxLayoutAlign="space-between">
                <mat-card fxFlex>
                  <mat-form-field class="full-width">
                    <mat-label>Añada un anuncio</mat-label>
                    <textarea matInput rows="8" placeholder="Ej. Respete la cuarentena..."></textarea>
                  </mat-form-field>
                  <mat-card-actions align="end">
                    <button mat-button color="warn">Limpiar</button>
                    <button mat-button color="accent" (click)="onNotify()">Enviar</button>
                  </mat-card-actions>
                </mat-card>
              </div>

            </mat-tab>
            <mat-tab label="Notificar Usuarios">
              <div class="f-min-height-width-padding" fxLayout="column" class="f-height" fxLayoutAlign="space-between">
                <mat-card fxFlex>
                  <form [formGroup]="reportCaseForm">
                    <div fxLayout="row wrap" fxLayoutAlign="center" fxLayoutGap="10px" fxLayoutAlign="space-evenly center">
                      <mat-form-field fxFlex>
                        <mat-label>Tipo de Documento</mat-label>
                        <mat-select formControlName="type" required>
                          <mat-option *ngFor="let docType of docTypes" [value]="docType">
                            {{docType}}
                          </mat-option>
                        </mat-select>
                      </mat-form-field>

                      <mat-form-field fxFlex>
                        <mat-label>Número de Documento</mat-label>
                        <input matInput type="text" formControlName="document" required>
                      </mat-form-field>

                      <mat-form-field fxFlex>
                        <mat-label>Tipo de Caso</mat-label>
                        <mat-select formControlName="report" required>
                          <mat-option *ngFor="let val of reportType" [value]="val">
                            {{val}}
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                      
                    </div>
                  </form>
                  <mat-card-actions align="end">
                    <button mat-button color="warn" type= "button" (click)="resetReportCaseForm()">Limpiar</button>
                    <button mat-button color="accent" type= "button" (click)="onReportCase()" [disabled]="!reportCaseForm.valid">Notificar</button>
                  </mat-card-actions>
                </mat-card>
              </div>

            </mat-tab>
          </mat-tab-group>
        </div>
      </div>
    </div>

    <!--Acá va el mapa-->

		<div fxFlex="70" fxFlex.lt-sm="50" fxFill style="background-color: aquamarine;">    
      <div #mapContainer id="map"></div>
    </div>
    
	</div>

</div>
